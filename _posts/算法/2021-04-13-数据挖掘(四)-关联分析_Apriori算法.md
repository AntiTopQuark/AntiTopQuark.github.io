---
layout: post
cid: 41
title: 数据挖掘(四)-关联分析 Apriori算法
slug: 41
date: 2021/04/13 17:35:29
updated: 2021/04/13 17:35:29
status: publish
author: AntiTopQuark
categories: 
  - 算法
tags: 
  - 任务
  - 数据
  - 记录
  - 过程
  - 原理
  - 计算
  - 机器学习
  - 步骤
  - 项集
  - 尿布
  - 集合
  - 物品
  - 频繁
customSummary: 
noThumbInfoStyle: default
outdatedNotice: no
reprint: standard
thumb: 
thumbChoice: default
thumbDesc: 
thumbSmall: 
thumbStyle: default
---



终于到了机器学习实战的第十一章了，这也是继K-均值后的第二个无监督学习算法了。同样的该算法也是在一堆数据集中寻找数据之间的某种关联，这里主要介绍的是叫做Apriori的‘一个先验’算法，通过该算法我们可以对数据集做关联分析——在大规模的数据中寻找有趣关系的任务，本文主要介绍使用Apriori算法发现数据的（频繁项集、关联规则）。
这些关系可以有两种形式：**频繁项集**、**关联规则**。
- 频繁项集：经常出现在一块的物品的集合
- 关联规则：暗示两种物品之间可能存在很强的关系
一个具体的例子：
![50602-1boc6ouqwyd.png](http://www.sukidesu.top/usr/uploads/2019/12/1264637589.png)
频繁项集是指那些经常出现在一起的物品，例如上图的{葡萄酒、尿布、豆奶}，从上面的数据集中也可以找到尿布->葡萄酒的关联规则，这意味着有人买了尿布，那很有可能他也会购买葡萄酒。那如何定义和表示频繁项集和关联规则呢？这里引入支持度和可信度（置信度）。
**支持度**：一个项集的支持度被定义为数据集中包含该项集的记录所占的比例，上图中，豆奶的支持度为4/5，（豆奶、尿布）为3/5。支持度是针对项集来说的，因此可以定义一个最小支持度，只保留最小支持度的项集。
**可信度（置信度）：**针对如{尿布}->{葡萄酒}这样的关联规则来定义的。计算为 支持度{尿布，葡萄酒}/支持度{尿布}，其中{尿布，葡萄酒}的支持度为3/5，{尿布}的支持度为4/5，所以“尿布->葡萄酒”的可行度为3/4=0.75，这意味着尿布的记录中，我们的规则有75%都适用。
有了可以量化的计算方式，我们却还不能立刻运算，这是因为如果我们直接运算所有的数据，运算量极其的大，很难实现，这里说明一下，假设我们只有 4 种商品：商品0，商品1，商品 2，商品3. 那么如何得可能被一起购买的商品的组合？
![53461-ef5hl7h2l89.png](http://www.sukidesu.top/usr/uploads/2019/12/1535437449.png)
上图显示了物品之间所有可能的组合，从上往下一个集合是 Ø，表示不包含任何物品的空集，物品集合之间的连线表明两个或者更多集合可以组合形成一个更大的集合。我们的目标是找到经常在一起购买的物品集合。这里使用集合的支持度来度量其出现的频率。一个集合出现的支持度是指有多少比例的交易记录包含该集合。例如，对于上图，要计算 0,3 的支持度，直接的想法是遍历每条记录，统计包含有 0 和 3 的记录的数量，使用该数量除以总记录数，就可以得到支持度。而这只是针对单个集合 0,3. 要获得每种可能集合的支持度就需要多次重复上述过程。对于上图，虽然仅有4中物品，也需要遍历数据15次。随着物品数目的增加，遍历次数会急剧增加，对于包含 N 种物品的数据集共有 2^N−1 种项集组合。为了降低计算时间，研究人员发现了 Apriori 原理，可以帮我们减少感兴趣的频繁项集的数目。
Apriori 的原理：如果某个项集是频繁项集，那么它所有的子集也是频繁的。即如果 {0,1} 是频繁的，那么 {0}, {1} 也一定是频繁的。

这个原理直观上没有什么用，但是反过来看就有用了，也就是说如果一个项集是非频繁的，那么它的所有超集也是非频繁的。如下图所示：
![61750-zcdgno2kw7.png](http://www.sukidesu.top/usr/uploads/2019/12/262765899.png)
## 频繁项集：
主要步骤：
- 首先会生成所有单个物品的项集列表
- 扫描交易记录来查看哪些项集满足最小支持度要求，那些不满足最小支持度的集合会被去掉
- 对剩下的集合进行组合以生成包含两个元素的项集
- 接下来重新扫描交易记录，去掉不满足最小支持度的项集，重复进行直到所有项集都被去掉

